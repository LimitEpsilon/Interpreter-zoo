\usepackage{setspace}
\usepackage{stmaryrd} % not in acmart
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{csquotes}
\usepackage{fancyvrb} % not in acmart
\usepackage{hyperref}
\usepackage{multicol} % not in acmart

%%% Colors
\definecolor{shadowcol}{rgb}{0.0, 0.0, 0.0}

%%% Math settings
\usepackage{amssymb,amsmath,amsthm}
\usepackage{mathtools} % not in acmart
\newtheorem{lem}{Lemma}[section]
\newtheorem{thm}{Theorem}[section]
\newtheorem{cor}{Corollary}[section]
\newtheorem{clm}{Claim}[section]
\newtheorem{defini}{Definition}[section]

%%% Theorem style
\newtheorem{notation}{Notation}[section]

%%% Example environment
\newcounter{example}
\counterwithin{example}{section}
\newenvironment{example}[1][]
{\refstepcounter{example}%
\begin{proof}[{\normalfont\textit{Example~\theexample#1}}]%
\renewcommand*{\qedsymbol}{\(\blacksquare\)}}%
{\end{proof}}

%%% PL constructs
\usepackage{galois} % not in acmart
\usepackage{mathpartir} % not in acmart
\usepackage{tikz} % not in acmart

%%% Custom symbols
\newcommand*{\vbar}{|}
\newcommand*{\cons}{::}
\newcommand*{\doubleplus}{\ensuremath{\mathbin{+\mkern-3mu+}}}
\newcommand*{\pset}[1]{\mathcal{P}({#1})}
\newcommand*{\closeloc}[2]{\prescript{\backslash{#1}}{}{#2}}
\newcommand*{\openloc}[2]{{#2}^{#1}}
\newcommand*{\Zero}{\mathsf{O}}
\newcommand*{\Succ}{\mathsf{S}}
\newcommand*{\synlink}{\rtimes}
\newcommand*{\semlink}{\mathbin{\domainst{\rotatebox[origin=c]{180}{$\propto$}}}}
\newcommand*{\semarrow}{\Downarrow}
\newcommand*{\equivalent}{\sim}

%%% push right or left in math mode
% https://tex.stackexchange.com/questions/83509/hfill-in-math-mode
\makeatletter
\newcommand{\specialcell}[1]{\ifmeasuring@#1\else\omit$\displaystyle#1$\ignorespaces\fi}
\newcommand{\pushright}[1]{\ifmeasuring@#1\else\omit\hfill$\displaystyle#1$\fi\ignorespaces}
\newcommand{\pushleft}[1]{\ifmeasuring@#1\else\omit$\displaystyle#1$\hfill\fi\ignorespaces}
\makeatother

%%% circled text
% https://tex.stackexchange.com/questions/7032/good-way-to-make-textcircled-numbers
\newcommand*{\circled}[1]{%
  \tikz[baseline=(char.base)]{%
    \node[shape=circle,draw=gray,inner sep=0.5pt] (char) {#1};}}

%%% for semantics
\def\ovbarw{1.2mu}
\def\ovbarh{1}
\newcommand*{\ovbar}[1]{\mkern \ovbarw\overline{\mkern-\ovbarw{\smash{#1}\scalebox{1}[\ovbarh]{\vphantom{i}}}\mkern-\ovbarw}\mkern \ovbarw}
\newcommand*{\A}[1]{\overset{\,_{\mbox{\Large .}}}{#1}}
\newcommand*{\Abs}[1]{{#1}^{\#}}
\newcommand*{\Absrel}[1]{\mathbin{{#1}^{\#}}}
\newcommand*{\domainst}[1]{\mathsf{#1}}
\newcommand*{\Expr}{\domainst{Expr}}
\newcommand*{\Var}{\domainst{Var}}
\newcommand*{\Ctx}{\domainst{Env}}
\newcommand*{\Bind}{\domainst{Bind}}
\newcommand*{\Clos}{\domainst{Clos}}
\newcommand*{\Mtx}{\domainst{MEnv}}
\newcommand*{\ctx}{\sigma}
\newcommand*{\bind}{\beta}
\newcommand*{\callstack}{\delta}
\newcommand*{\Value}{\domainst{Val}}
\newcommand*{\Malue}{\domainst{MVal}}
\newcommand*{\Walue}{\domainst{WVal}}
\newcommand*{\Mem}{\domainst{Mem}}
\newcommand*{\Heap}{\domainst{Heap}}
\newcommand*{\Loc}{\domainst{Anchor}}
\newcommand*{\Anchor}{\domainst{Anchor}}
\newcommand*{\FLoc}{\textnormal{FLoc}}
\newcommand*{\Addr}{\domainst{Addr}}
\newcommand*{\SAddr}{\domainst{SAddr}}
\newcommand*{\mem}{m}
\newcommand*{\heap}{H}
\newcommand*{\dom}{\textnormal{dom}}
\newcommand*{\lfp}{\textnormal{lfp}}
\newcommand*{\Step}{\textnormal{Step}}
\newcommand*{\step}{\textnormal{step}}

\newcommand*{\Link}{\textnormal{Link}}
\newcommand*{\link}{\textnormal{link}}
\newcommand*{\sembracket}[1]{\llbracket{#1}\rrbracket}
\newcommand*{\fin}[2]{{#1}\xrightarrow{\mbox{\tiny{fin}}}{#2}}
\newcommand*{\eval}{\textnormal{eval}}

%%% symbol standing for partial proof tree, or ``table''
\newcommand*{\ptree}{t}

%%% program point
\newcommand*{\ppoint}{p}

%%% labelled expressions {p:e}
\newcommand*{\plabel}[2]{\prescript{\tiny#1}{}{(#2)}}

%%% labelled locations \ell^p
\newcommand*{\llabel}[2]{{#2}^{#1}}

%%% big-step evaluation judgment σ ⊢ e ⇓ v
\newcommand*{\evjudg}[3]{{#1}\vdash{#2}\Downarrow{#3}}

%%% typing judgment Γ ⊢ e : τ, S
\newcommand*{\typejudg}[4]{{#1}\vdash{#2}:{#3},{#4}}

%%% semantic typing judgment Γ ⊨ e : τ, S
\newcommand*{\semtypejudg}[4]{{#1}\vDash{#2}:{#3},{#4}}

%%% separation logic triple {P}C{Q}
\newcommand*{\triple}[3]{\{{#1}\}\,{#2}\,\{{#3}\}}

%%% heap assertion standing for the empty heap
\newcommand*{\emp}{\mathsf{emp}}

\newcommand*{\arrowty}[3]{{#1}\xrightarrow{\mbox{\tiny$#2$}}{#3}}
\newcommand*{\ValRel}[1]{\mathcal{V}\sembracket{#1}}
\newcommand*{\WalRel}[1]{\mathcal{W}\sembracket{#1}}
\newcommand*{\ExprRel}[1]{\mathcal{X}\sembracket{#1}}
\newcommand*{\CtxRel}[1]{\mathcal{C}\sembracket{#1}}
\newcommand*{\EvtRel}[1]{\mathcal{\event}\sembracket{#1}}
\newcommand*{\ModRel}[1]{\mathcal{M}\sembracket{#1}}
\newcommand*{\TyEnv}{\domainst{TyEnv}}
\newcommand*{\TyVar}{\domainst{TyVar}}
\newcommand*{\Type}{\domainst{Type}}
\newcommand*{\Subst}{\textnormal{Subst}}
\newcommand*{\Safe}{S}
\newcommand*{\unsafe}{\textnormal{unsafe}}

%%% syntax for the match construct
\newcommand*{\synmatch}[4]{%
  \texttt{match}\:
  {#1}\:
  \texttt{\{O}\rightarrow{#2}\texttt{,}\:
  \texttt{S}\:{#3}\rightarrow{#4}\texttt{\}}
}
\newcommand*{\semmatch}[4]{%
  \mathsf{Match}\:
  {#1}\:
  \mathsf{\{O}\Mapsto{#2}\texttt{,}\:
  \mathsf{S}\:{#3}\Mapsto{#4}\texttt{\}}
}
%%% syntax for the bind construct
\newcommand*{\synbind}[3]{%
  {#1}\:\texttt{=}\:{#2}
  \:\texttt{;}\:
  {#3}
}

%%% events
\newcommand*{\abbrtext}[1]{{#1}}
\newcommand*{\Hd}{\abbrtext{Hd}}
\newcommand*{\Tl}{\abbrtext{Tl}}
\newcommand*{\event}{S}
\newcommand*{\Event}{\domainst{Shadow}}
\newcommand*{\InitE}{\textcolor{shadowcol}{\mathsf{Init}}}
\newcommand*{\ReadE}{\textcolor{shadowcol}{\mathsf{Read}}}
\newcommand*{\CallE}{\textcolor{shadowcol}{\mathsf{Call}}}
\newcommand*{\SuccE}{\textcolor{shadowcol}{\mathsf{Succ}}}
\newcommand*{\PredE}{\textcolor{shadowcol}{\mathsf{Pred}}}
\newcommand*{\MatchE}{\textcolor{shadowcol}{\mathsf{Match}}}
\newcommand*{\DerefSE}{\textcolor{shadowcol}{\mathsf{Deref}}}
\newcommand*{\DerefAE}{\textcolor{shadowcol}{\mathsf{Deref}}}

% semantic function 
\newcommand*{\predE}{\textcolor{shadowcol}{\textit{pred}}}


%%% selectors
\newcommand*{\selin}[1]{{#1}^{\shortdownarrow}}
\newcommand*{\selout}[1]{{#1}^{\shortuparrow}}
\newcommand*{\selio}[1]{{#1}^{\shortdownarrow,\shortuparrow}}
\newcommand*{\selbind}[2][\!\!.\,]{{#2}#1\mathsf{b}}
\newcommand*{\selevent}[2][\!\!.\,]{{#2}#1\mathsf{s}}
\newcommand*{\selctx}[2][\!\!.\,]{{#2}#1\mathsf{e}}
\newcommand*{\selval}[2][\!\!.\,]{{#2}#1\mathsf{v}}
\newcommand*{\selmem}[2][\!\!.\,]{{#2}#1\mathsf{\mem}}
\newcommand*{\selclos}[2][\!\!.\,]{{#2}#1\mathsf{c}}

